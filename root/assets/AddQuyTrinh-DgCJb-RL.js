import{s as Sl,_ as Ql,a as Xl,b as Kl,c as Ol}from"./datetimepicker.vue_vue_type_script_setup_true_lang-DHVuaTT6.js";import{d as cl,P as n,ai as Wl,I as xl,S as gl,ac as Ml,o as P,a as L,b as l,aj as Yl,ak as Rl,af as i,h as S,al as Z,e as t,w as o,an as tl,f as B,ag as A,v as R,F as il,r as bl,t as W,am as _l,aL as nl,bl as dl,bm as Pl,R as Ll,bn as ml,ah as Cl,V as jl}from"./index-yLVU4Ex3.js";import{V as Vl}from"./VCard-CEBs-cN-.js";import{V as wl}from"./VSpacer-8kzBF65J.js";import{V as pl}from"./scopeId-C6LQZbL7.js";import{V as el,a as h}from"./forwardRefs-CL6gp1Ft.js";import{V as Fl}from"./VDialog-wcZ8aBeV.js";import{V as fl}from"./VCheckbox-Hmn0GsLK.js";import{G as Jl,P as Zl,R as le,a as kl,E as ee,C as ae,L as Bl}from"./standard-Cqu3hj39.js";import{_ as te}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{V as ne}from"./VSnackbar-BlYJOY5q.js";import"./VInput-C1v2JwYH.js";const oe={id:"bieudoquytrinh"},ue={class:"combobox-container"},se=["value"],ie={class:"FontDefault",style:{"font-size":"15px"}},de={class:"sliding-panel-content"},re={class:"input-container"},ve=cl({__name:"AddNode",emits:["emit_Node"],setup(ol,{emit:q}){let V=n(!1),x="",f=n(""),m=n(""),N=n(!1),I=n(0),g=n(""),G=n(!1),M=n(!1),w=n(""),$=n([]),H=n([]),z=n(""),U=n([]),F=n([]),d=n(""),v=n(""),T=n(!1),k=n(!1),j=n(!1),J=n(!0),Q=n(!1),X=n(!1),K=n(!1),D=n(!1),p=n(!1),Y=n(!1),ll=n(!1);const b=n(!1),a=Wl({x:0,y:0}),rl=xl(()=>({top:`${a.y}px`,left:`${a.x+20}px`}));let hl,al;const vl=n(null);let c=null,r=null;const C=n({INodeMap:[],IDiagram:[],INextStep:[],InodeSttings:[]});let Il=n({INodeMap:[]});const yl=q;gl(()=>{var e;al=new Jl({},{cellNamespace:Sl}),hl=new Zl({el:vl.value,model:al,width:window.innerWidth,height:window.innerHeight-30,gridSize:10,drawGrid:!0,overflow:!0,cellViewNamespace:Sl});let s=!1;hl.on("element:contextmenu",(y,E,_,u)=>{E.preventDefault(),s=!0,r=y.model,a.x=_+300,a.y=u+50,b.value=!0,ll.value=!0,Tl(r==null?void 0:r.id)}),(e=vl.value)==null||e.addEventListener("contextmenu",y=>{if(y.preventDefault(),s){s=!1;return}const E=y.target;r=null,E.closest(".element")||(b.value=!0,ll.value=!1,Tl(""))}),al.on("change:position",y=>{var E;if(y.isElement()){const _=(E=C.value.INodeMap)==null?void 0:E.find(u=>u.keyId==y.id);_&&(_.x=y.position().x,_.y=y.position().y)}})});const Al=s=>{s.preventDefault(),a.x=s.clientX+30,a.y=s.clientY-100,b.value=!0},ul=()=>{b.value=!1},El=s=>{let e,y=f.value;if(s==="1"?(e=new le,e.attr({body:{fill:"#0099CC",stroke:"black",strokeWidth:1},label:{text:y,fill:"black",refY:60}}),e.resize(50,50)):s==="2"?(e=new kl,e.attr({body:{refPoints:"50,0 100,50 50,100 0,50",fill:"#FFE4B5",stroke:"black",strokeWidth:1},label:{text:y,fill:"black",refY:80}}),e.resize(70,70)):s==="3"?(e=new kl,e.attr({body:{refPoints:"50,0 100,50 50,100 0,50",fill:"#B5EAD7",stroke:"black",strokeWidth:1},label:{text:y,fill:"black",refY:80}}),e.resize(70,70)):s==="4"?(e=new kl,e.attr({body:{refPoints:"50,0 100,50 50,100 0,50",fill:"#CC0033",stroke:"black",strokeWidth:1},label:{text:y,fill:"black",refY:"100%",refY2:10,textAnchor:"middle",yAlignment:"middle"}}),e.resize(70,70)):s==="5"?(e=new ee,e.attr({body:{fill:"#87CEFA",stroke:"black",strokeWidth:1},label:{text:y,fill:"black",refY:60}}),e.resize(70,50)):s==="tron"&&(e=new ae,e.attr({body:{fill:"lightblue"},label:{text:y,fill:"black",refY:60}}),e.resize(50,50)),!e)return;const E=a.x-250,_=a.y;e.position(E,_),al.addCell(e),C.value.INodeMap.push({index:I.value,x:E,keyId:e.id,type:parseInt(s),tenNode:y,y:_}),I.value++;let u=r||c;const O=new Bl;switch(C.value.INextStep.length==0&&(u=null),u&&(O.source(u),O.target(e),O.attr({line:{stroke:"black",strokeWidth:1}}),O.appendLabel({attrs:{text:{text:m.value,fill:"black",fontSize:14}},position:{distance:.5}}),O.router("orthogonal"),O.connector("straight",{cornerType:"line"}),al.addCell(O),C.value.IDiagram.push({keyId:O.id,source:u.id.toString(),target:e.id,tenDiagram:m.value})),s){case"5":{C.value.INextStep.push({nodeIdStart:e.id,nodeIdEnd:"",diagramId:"",actionName:m.value,action:0,typeNextStep:parseInt(s)});break}default:{C.value.INextStep.push({nodeIdStart:u==null?void 0:u.id,nodeIdEnd:e.id,diagramId:O.id,actionName:m.value,action:0,typeNextStep:parseInt(s)});break}}c=e,r=null,ul()},Ul=()=>{r?(r.remove(),C.value.INodeMap=C.value.INodeMap.filter(s=>s.keyId!=(r==null?void 0:r.id)),C.value.IDiagram=C.value.IDiagram.filter(s=>s.source!=(r==null?void 0:r.id)),C.value.INextStep=C.value.INextStep.filter(s=>s.nodeIdStart!=(r==null?void 0:r.id)),C.value.INextStep=C.value.INextStep.filter(s=>s.nodeIdEnd!=(r==null?void 0:r.id)),C.value.InodeSttings=C.value.InodeSttings.filter(s=>s.keyNode!=(r==null?void 0:r.id)),r=null,yl("emit_Node",C.value)):alert("Vui lòng chọn node cần xóa"),ul()};function Hl(){if(r){if(g.value==r.id){M.value=!0,w.value="Không được chọn cùng bước để trả về";return}const s=new Bl;s.source({id:r.id}),s.target({id:g.value}),s.attr({line:{stroke:"black",strokeWidth:1}}),s.appendLabel({attrs:{text:{text:m.value,fill:"black",fontSize:14}},position:{distance:.5}}),s.router("orthogonal"),s.connector("straight",{cornerType:"line"}),al.addCell(s),C.value.INextStep.push({nodeIdStart:r==null?void 0:r.id,nodeIdEnd:g.value,diagramId:s.id,actionName:m.value,action:0,typeNextStep:6}),C.value.IDiagram.push({keyId:s.id,source:r.id.toString(),target:g.value,tenDiagram:m.value})}else alert("Vui lòng chọn click chuột phải để chọn bước thực hiện");ul()}function $l(){var y;N.value=!N.value,ul();const s=C.value.INodeMap.find(E=>E.keyId==(r==null?void 0:r.id));if(s==null)return;z.value=((y=s==null?void 0:s.tenNode)==null?void 0:y.toString())??"";const e=C.value.InodeSttings.find(E=>E.keyNode==(r==null?void 0:r.id));e==null?(H.value=[],F.value=[],d.value="",v.value="",T.value=!1,k.value=!1,j.value=!1):(H.value=e.phongBanNodeModels,F.value=e.nhanSuNodeModels,d.value=e.ghiChu??"",v.value=e.cauHinhMailNhacNho.toString(),T.value=e.isTaoTaskBaoCao,k.value=e.isGuiMailPhongBanTiepNhan,j.value=e.isGuiMailNhacNho)}function Dl(s){if(s==!1)V.value=!1;else{if(f.value===""){M.value=!0,w.value="Vui lòng điền tên bước quyt trình",V.value=!1,f.value="",m.value="";return}G.value==!0?(Hl(),g.value=""):El(x),V.value=!1}yl("emit_Node",C.value),f.value="",m.value=""}function sl(s){V.value=!0,x=s,s=="thoi_trave"?G.value=!0:G.value=!1,ul()}function Nl(s){var e;N.value=!1,s?(C.value.InodeSttings.find(E=>E.keyNode==(r==null?void 0:r.id))!=null&&(C.value.InodeSttings=C.value.InodeSttings.filter(E=>E.keyNode!=(r==null?void 0:r.id))),C.value.InodeSttings.push({keyNode:((e=r==null?void 0:r.id)==null?void 0:e.toString())??"",nhanSuNodeModels:U.value,phongBanNodeModels:$.value,ghiChu:d.value,isTaoTaskBaoCao:T.value,isGuiMailPhongBanTiepNhan:k.value,isGuiMailNhacNho:j.value,cauHinhMailNhacNho:parseInt(v.value)}),yl("emit_Node",C.value)):(F.value=[],H.value=[])}function Tl(s){const e=C.value.INodeMap;C.value.IDiagram;const y=C.value.INextStep;if(s.length>0){let E=e.find(_=>_.keyId==s);switch(E==null?void 0:E.type){case 5:{y.length==1?(J.value=X.value=K.value=D.value=p.value=!1,Q.value=!0):Q.value=J.value=X.value=K.value=D.value=p.value=!1;break}case 1:{y.filter(_=>_.nodeIdStart==s).length>0?(Q.value=J.value=p.value=!1,X.value=K.value=D.value=!1):(J.value=p.value=!1,Q.value=X.value=K.value=D.value=!0);break}case 2:{if(Q.value=K.value=D.value=p.value=!0,y.filter(u=>u.nodeIdStart==s).length==0)J.value=!1;else{const u=y.filter(O=>O.nodeIdStart==s);if(u.length>=3){Q.value=X.value=K.value=D.value=p.value=!1;break}u.forEach(O=>{switch(O==null?void 0:O.typeNextStep){case 1:{Q.value=!1;break}case 3:{D.value=!1;break}case 4:{K.value=!1;break}case 6:{p.value=!1;break}default:Q.value=X.value=K.value=D.value=p.value=!1;break}})}X.value=!1;const _=y.find(u=>u.nodeIdStart==s);Il.value.INodeMap=e.filter(u=>u.type!=2&&u.type!=5&&u.keyId!=(_==null?void 0:_.nodeIdEnd));break}case 3:{Q.value=X.value=K.value=D.value=p.value=!1,Y.value=!0;break}case 4:Q.value=X.value=K.value=D.value=p.value=!1,Y.value=!0}e.length==1||y.filter(_=>_.nodeIdStart==s).length==1&&y.filter(_=>_.typeNextStep==6).length==1?Y.value=!0:y.filter(_=>_.nodeIdStart==s).length>=1?Y.value=!1:Y.value=!0}else y.length<=0?(Q.value=X.value=K.value=D.value=p.value=!1,J.value=!0,Y.value=!1):y.length>0&&(Q.value=!0,J.value=X.value=K.value=D.value=p.value=!1,Y.value=!1)}const ql=s=>{$.value=s},Gl=s=>{U.value=s};function zl(){F.value=[]}return(s,e)=>{const y=Ql,E=Xl,_=Ml("v-container-fluid");return P(),L(il,null,[l("div",oe,[l("div",{ref_key:"paperContainer",ref:vl,class:"diagram-container",onContextmenu:Yl(Al,["prevent"])},null,544)]),b.value?(P(),L("div",{key:0,style:Rl(rl.value),class:"context-menu FontDefault"},[l("ul",null,[i(J)?(P(),L("li",{key:0,onClick:e[0]||(e[0]=u=>sl("5")),style:{color:"#87CEFA"}},e[21]||(e[21]=[l("span",{class:"icon-border2",style:{color:"#87CEFA"}},[l("i",{class:"fas fa-circle"})],-1),S(" Tạo bước bắt đầu ")]))):Z("",!0),i(Q)?(P(),L("li",{key:1,onClick:e[1]||(e[1]=u=>sl("1")),style:{color:"#0099CC"}},e[22]||(e[22]=[l("span",{class:"icon-border2",style:{color:"#0099CC"}},[l("i",{class:"fas fa-square"})],-1),S(" Tạo bước tiếp theo ")]))):Z("",!0),i(X)?(P(),L("li",{key:2,onClick:e[2]||(e[2]=u=>sl("2")),style:{color:"#FF9933"}},e[23]||(e[23]=[l("span",{class:"icon-border2",style:{color:"#FF9933"}},[l("i",{class:"fas fa-exclamation-triangle"})],-1),S(" Tạo bước điều kiện ")]))):Z("",!0),i(p)?(P(),L("li",{key:3,onClick:e[3]||(e[3]=u=>sl("thoi_trave")),style:{color:"#FF9933"}},e[24]||(e[24]=[l("span",{class:"icon-border2",style:{color:"#FF9933"}},[l("i",{class:"fas fa-undo-alt"})],-1),S(" Trả về hoặc chuyển bước ")]))):Z("",!0),i(D)?(P(),L("li",{key:4,onClick:e[4]||(e[4]=u=>sl("3")),style:{color:"#009966"}},e[25]||(e[25]=[l("span",{class:"icon-border2",style:{color:"#009966"}},[l("i",{class:"fas fa-check"})],-1),S(" Duyệt ")]))):Z("",!0),i(K)?(P(),L("li",{key:5,onClick:e[5]||(e[5]=u=>sl("4")),style:{color:"#CC0033"}},e[26]||(e[26]=[l("span",{class:"icon-border2",style:{color:"#CC0033"}},[l("i",{class:"fas fa-times"})],-1),S(" Từ chối ")]))):Z("",!0),i(ll)?(P(),L("li",{key:6,onClick:$l},e[27]||(e[27]=[l("span",{class:"icon-border2"},[l("i",{class:"fa fa-gear"})],-1),S(" Cấu hình bước ")]))):Z("",!0),i(Y)?(P(),L("li",{key:7,onClick:Ul},e[28]||(e[28]=[l("span",{class:"icon-border2"},[l("i",{class:"fas fa-trash-alt"})],-1),S(" Xóa ")]))):Z("",!0),l("li",{onClick:ul},"Hủy")])],4)):Z("",!0),t(Fl,{modelValue:i(V),"onUpdate:modelValue":e[11]||(e[11]=u=>A(V)?V.value=u:V=u),"max-width":"400",persistent:""},{activator:o(({props:u})=>e[29]||(e[29]=[])),default:o(()=>[t(Vl,{title:"Tạo bước quy trình"},{actions:o(()=>[t(wl),t(tl,{onClick:e[9]||(e[9]=u=>Dl(!1)),class:"btnCancel no-uppercase"},{default:o(()=>e[35]||(e[35]=[S(" Hủy ")])),_:1}),t(tl,{class:"btnAdd btn no-uppercase",onClick:e[10]||(e[10]=u=>Dl(!0))},{default:o(()=>e[36]||(e[36]=[S(" Xác nhận ")])),_:1})]),default:o(()=>[t(pl,null,{default:o(()=>[t(el,null,{default:o(()=>[t(h,{cols:"12",md:"12"},{default:o(()=>[e[30]||(e[30]=l("label",{class:"FontDefault"},[l("div",{style:{display:"inline-block","vertical-align":"middle",color:"red"}},"*"),S(" Tên bước quy trình ")],-1)),B(l("input",{type:"text",id:"",class:"FontDefault",placeholder:"VD: Bước duyệt quy trình",style:{width:"100%"},"onUpdate:modelValue":e[6]||(e[6]=u=>A(f)?f.value=u:f=u)},null,512),[[R,i(f)]])]),_:1}),t(h,{cols:"12",md:"12"},{default:o(()=>[e[31]||(e[31]=l("label",{class:"FontDefault"}," Tên luồng chuyền (mũi tên) ",-1)),B(l("input",{type:"text",id:"",class:"FontDefault",placeholder:"VD: Chuyển quy trình bước 1 sang bước 2",style:{width:"100%"},"onUpdate:modelValue":e[7]||(e[7]=u=>A(m)?m.value=u:m=u)},null,512),[[R,i(m)]])]),_:1}),B(t(h,{cols:"12",md:"12"},{default:o(()=>[e[34]||(e[34]=l("label",{class:"FontDefault"}," Trả về hoặc chuyển cho bước: ",-1)),l("div",ue,[B(l("select",{class:"combobox","onUpdate:modelValue":e[8]||(e[8]=u=>A(g)?g.value=u:g=u)},[e[32]||(e[32]=l("option",{value:"",key:"0"},null,-1)),(P(!0),L(il,null,bl(i(Il).INodeMap,(u,O)=>(P(),L("option",{key:u.keyId||"",value:u.keyId||""},W(u.tenNode),9,se))),128))],512),[[_l,i(g)]]),e[33]||(e[33]=l("span",{class:"combobox-icon"},"▼",-1))])]),_:1},512),[[nl,i(G)]])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(Fl,{modelValue:i(M),"onUpdate:modelValue":e[13]||(e[13]=u=>A(M)?M.value=u:M=u),"max-width":"400",persistent:""},{activator:o(({props:u})=>e[37]||(e[37]=[])),default:o(()=>[t(Vl,{title:"Thông báo lỗi"},{actions:o(()=>[t(wl),t(tl,{class:"btnAdd btn no-uppercase",onClick:e[12]||(e[12]=u=>A(M)?M.value=!1:M=!1)},{default:o(()=>e[38]||(e[38]=[S(" Xác nhận ")])),_:1})]),default:o(()=>[t(pl,null,{default:o(()=>[t(el,null,{default:o(()=>[t(h,{cols:"12",md:"12"},{default:o(()=>[l("label",ie,W(i(w))+" ! ",1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),l("div",{class:dl(["sliding-panel FontDefault",{open:i(N)}])},[l("div",de,[t(_,null,{default:o(()=>[t(el,null,{default:o(()=>[t(h,{cols:"12",md:"12"},{default:o(()=>[l("h3",null,"Cấu hình bước: "+W(i(z)),1)]),_:1}),t(h,{cols:"12",md:"12"},{default:o(()=>[e[39]||(e[39]=l("label",{class:"FontDefault"}," Người tiếp nhận ",-1)),t(y,{phognbanId:i(H),onEmit_phonganId:ql,onChange:zl},null,8,["phognbanId"])]),_:1}),t(h,{cols:"12",md:"12"},{default:o(()=>[e[40]||(e[40]=l("label",{class:"FontDefault"}," Phòng ban tiếp nhận ",-1)),t(E,{nhansuIdMap:i(F),ListPhongBanId:i($),onEmit_nhansuId:Gl},null,8,["nhansuIdMap","ListPhongBanId"])]),_:1}),t(h,{cols:"12",md:"12"},{default:o(()=>[l("div",re,[e[41]||(e[41]=l("label",{for:"",class:"FontDefault"}," Ghi chú ",-1)),B(l("textarea",{"onUpdate:modelValue":e[14]||(e[14]=u=>A(d)?d.value=u:d=u),class:"form-control",placeholder:"Nội dung ghi chú"},null,512),[[R,i(d)]])])]),_:1}),t(h,{cols:"12",md:"12"},{default:o(()=>[e[42]||(e[42]=l("label",{class:"FontDefault"}," Cấu hình mail nhắc nhở ",-1)),B(l("input",{type:"number",id:"",class:"FontDefault",placeholder:"Số mỗi lần gửi mail cách nhau bao nhiêu phút",style:{width:"100%"},min:"0",max:"1440","onUpdate:modelValue":e[15]||(e[15]=u=>A(v)?v.value=u:v=u)},null,512),[[R,i(v)]])]),_:1}),t(h,{cols:"12",md:"12"},{default:o(()=>[t(fl,{label:"Tạo báo cáo tự động khi hoàn thành.",class:"FontDefault",modelValue:i(T),"onUpdate:modelValue":e[16]||(e[16]=u=>A(T)?T.value=u:T=u)},null,8,["modelValue"]),t(fl,{label:"Gửi mail cho người/phòng ban tiếp nhận.",class:"FontDefault",style:{"margin-top":"-50px"},modelValue:i(k),"onUpdate:modelValue":e[17]||(e[17]=u=>A(k)?k.value=u:k=u)},null,8,["modelValue"]),t(fl,{label:"Gửi mail nhắc nhở nếu có (có cấu hình).",class:"FontDefault",style:{"margin-top":"-50px"},modelValue:i(j),"onUpdate:modelValue":e[18]||(e[18]=u=>A(j)?j.value=u:j=u)},null,8,["modelValue"])]),_:1}),t(h,{cols:"12",md:"12"},{default:o(()=>[t(tl,{class:"btnAdd btn no-uppercase",onClick:e[19]||(e[19]=u=>Nl(!0)),style:{float:"right"}},{default:o(()=>e[43]||(e[43]=[S(" Xác nhận ")])),_:1}),t(tl,{onClick:e[20]||(e[20]=u=>Nl(!1)),class:"btnCancel no-uppercase",style:{float:"right","margin-right":"10px"}},{default:o(()=>e[44]||(e[44]=[S(" Hủy ")])),_:1})]),_:1})]),_:1})]),_:1})])],2),l("div",{class:dl(["overlay",{show:i(N)}])},null,2)],64)}}}),fe=te(ve,[["__scopeId","data-v-45c11a2c"]]),pe={class:"multi-select-nhansu FontDefault"},ce={class:"arrow"},he={key:0,class:"dropdown-nhansu"},me={class:"dropdown-item-phongban"},ge=["id","value"],be=["for"],ye=cl({__name:"CBCheckNhanSu",props:{ListPhongBanId:{}},emits:["emit_nhansuId"],setup(ol,{emit:q}){const V=n(""),x=n([]),f=n([]),m=n(!1),N=ol,I=n({succeeded:null,code:null,message:null,errors:null,data:[]});let g={succeeded:null,code:null,message:null,errors:null,data:[]};const G=q,M=()=>{const d=V.value.toLowerCase();I.value.data=g.data,d.length>=1?I.value.data=g.data.filter(v=>(v.firstName+v.lastName).toLocaleLowerCase().includes(d)):I.value.data=g.data},w=()=>{m.value=!m.value},$=d=>{const v=document.querySelector(".multi-select-nhansu");v&&!v.contains(d.target)&&(m.value=!1),G("emit_nhansuId",x.value)};function H(){if(f.value=[],U.value==!0){f.value.push("Tất cả");return}x.value.forEach(d=>{const v=g.data.find(T=>T.id==d);v&&f.value.push(v.firstName+" "+v.lastName)})}async function z(){try{g=await Cl("/api/account/GetAllUser","GET",{},{timeout:15e3}),I.value={...g,data:[...g.data]}}catch(d){console.log("Lỗi comboxbo nhân sự "+d)}}const U=xl(()=>g.data.length>0&&x.value.length===g.data.length),F=()=>{U.value?(x.value=[],f.value=[]):(x.value=g.data.map(d=>d.id),H())};return gl(()=>{document.addEventListener("click",$),z()}),Pl(()=>{document.removeEventListener("click",$)}),Ll(()=>N.ListPhongBanId,(d,v)=>{x.value=[],f.value=[],I.value.data=g.data,d.length>0&&(I.value.data=I.value.data.filter(T=>d.includes(T.phongBanId)))},{deep:!0,immediate:!0}),(d,v)=>(P(),L("div",pe,[l("div",{class:"dropdown-header-nhansu",onClick:w},[l("span",{class:dl({placeholder:x.value.length===0})},W(f.value.length>0?f.value.join(", "):"Chọn nhân sự..."),3),l("span",ce,W(m.value?"▲":"▼"),1)]),m.value?(P(),L("div",he,[l("div",me,[B(l("input",{type:"checkbox",id:"checkAll","onUpdate:modelValue":v[0]||(v[0]=T=>A(U)?U.value=T:null),onChange:F},null,544),[[ml,i(U)]]),v[4]||(v[4]=l("label",{for:"checkAll"},[l("strong",null,"Chọn tất cả")],-1))]),B(l("input",{type:"text","onUpdate:modelValue":v[1]||(v[1]=T=>V.value=T),placeholder:"Tìm kiếm...",style:{width:"100%","margin-bottom":"10px"},onInput:M},null,544),[[R,V.value]]),(P(!0),L(il,null,bl(I.value.data,T=>(P(),L("div",{key:T.id,class:"dropdown-item-nhansu"},[B(l("input",{type:"checkbox",id:T.id,value:T.id,"onUpdate:modelValue":v[2]||(v[2]=k=>x.value=k),onChange:v[3]||(v[3]=k=>H())},null,40,ge),[[ml,x.value]]),l("label",{for:T.id},W(T.firstName+T.lastName),9,be)]))),128))])):Z("",!0)]))}}),ke={class:"multi-select-phongban FontDefault"},xe={class:"arrow"},Ce={key:0,class:"dropdown-phongban"},Ie={class:"dropdown-item-phongban"},De=["value"],Ne=cl({__name:"CBCheckPhongBan",emits:["emit_phonganId"],setup(ol,{emit:q}){const V=n(""),x=n([]),f=n([]),m=n(!1);let N={succeeded:null,code:null,message:null,errors:null,data:[]};const I=n({succeeded:null,code:null,message:null,errors:null,data:[]}),g=q,G=()=>{const F=V.value.toLowerCase();I.value.data=N.data,F.length>=1?I.value.data=N.data.filter(d=>d.tenPhongBan.toLowerCase().includes(F)):I.value.data=N.data},M=xl(()=>N.data.length>0&&x.value.length===N.data.length),w=()=>{M.value?(x.value=[],f.value=[]):(x.value=N.data.map(F=>F.id),U())},$=()=>{m.value=!m.value},H=F=>{const d=document.querySelector(".multi-select-phongban");d&&!d.contains(F.target)&&(m.value=!1),g("emit_phonganId",x.value)};async function z(){try{N=await Cl("/api/quanlythongtin/PhongBan/DanhSachPhongBan","GET",{},{timeout:15e3}),N.data.sort((d,v)=>d.id-v.id),I.value={...N,data:[...N.data]}}catch(F){console.log("Lỗi combobox phòng ban: "+F)}}function U(){if(f.value=[],M.value==!0){f.value.push("Tất cả");return}x.value.forEach(F=>{const d=N.data.find(v=>v.id==F);d&&f.value.push(d.tenPhongBan)})}return gl(()=>{document.addEventListener("click",H),z()}),Pl(()=>{document.removeEventListener("click",H)}),(F,d)=>(P(),L("div",ke,[l("div",{class:"dropdown-header-phongban",onClick:$},[l("span",{class:dl({placeholder:x.value.length===0})},W(f.value.length>0?f.value.join(", "):"Chọn phòng ban..."),3),l("span",xe,W(m.value?"▲":"▼"),1)]),m.value?(P(),L("div",Ce,[l("div",Ie,[B(l("input",{type:"checkbox",id:"checkAll","onUpdate:modelValue":d[0]||(d[0]=v=>A(M)?M.value=v:null),onChange:w},null,544),[[ml,i(M)]]),d[4]||(d[4]=l("label",{for:"checkAll"},[l("strong",null,"Chọn tất cả")],-1))]),B(l("input",{type:"text","onUpdate:modelValue":d[1]||(d[1]=v=>V.value=v),placeholder:"Tìm kiếm...",style:{width:"100%","margin-bottom":"10px"},onInput:G},null,544),[[R,V.value]]),(P(!0),L(il,null,bl(I.value.data,v=>(P(),L("div",{key:v.id,class:"dropdown-item-phongban"},[B(l("input",{type:"checkbox",value:v.id,"onUpdate:modelValue":d[2]||(d[2]=T=>x.value=T),onChange:d[3]||(d[3]=T=>U())},null,40,De),[[ml,x.value]]),l("label",null,W(v.tenPhongBan),1)]))),128))])):Z("",!0)]))}}),Te={class:"input-container"},Se={class:"input-container"},Ve={class:"input-container"},we={class:"FontDefault"},Fe={style:{"text-align":"center"}},Be={class:"tooltip"},Me=["onClick"],_e={class:"sliding-panel-content"},Pe={class:"combobox-container"},Le=cl({__name:"AddCauHinhQuyTrinh",props:{DanhSachNode:{}},emits:["emit_DanhSachCauHinh"],setup(ol,{emit:q}){let V=n(!1),x=n([]),f=n(""),m=n(""),N=n(""),I=n(""),g=n("");const G=n();let M=n([]),w=n(0),$=n(!1),H=n(!1),z=n(""),U=n(""),F=n([]),d=n([]);const v=q,T=ol,k=n([]),j=n([]),J=b=>{k.value.push(b)};function Q(){J({index:k.value.length,tenThonTin:"Chưa cấu hình",noiDung:"",thongBao:null,loaiThongTin:0,kichThuocKyTu:0,isBatBuocnhap:!1,isFileDinhKem:!1,danhSachCauHinhBuoc:[]})}function X(){const b=k.value.findIndex(a=>a.index==G.value);k.value[b].tenThonTin=I.value,k.value[b].noiDung=g.value,k.value[b].danhSachCauHinhBuoc=M.value??[],k.value[b].loaiThongTin=parseInt(w.value.toString()),k.value[b].isBatBuocnhap=$.value,k.value[b].isFileDinhKem=H.value,k.value[b].thongBao=z.value,k.value[b].kichThuocKyTu=parseInt(U.value),V.value=!1,G.value=null,I.value="",f.value="",M.value=null}function K(){k.value=k.value.filter(b=>b.index!=G.value),V.value=!1,G.value=null}function D(b){V.value=!0,G.value=b;const a=k.value.find(rl=>rl.index==b);(a==null?void 0:a.danhSachCauHinhBuoc.length)==0?(I.value="",$.value=!1,w.value=0,H.value=!1,z.value="",g.value="",U.value="0",M.value=[],F.value=[]):(I.value=(a==null?void 0:a.tenThonTin)??"",g.value=(a==null?void 0:a.noiDung)??"",$.value=(a==null?void 0:a.isBatBuocnhap)??!1,w.value=(a==null?void 0:a.loaiThongTin)??0,H.value=(a==null?void 0:a.isFileDinhKem)??!1,z.value=(a==null?void 0:a.thongBao)??"",f.value=(a==null?void 0:a.noiDung)??"",U.value=(a==null?void 0:a.kichThuocKyTu.toString())??"",M.value=(a==null?void 0:a.danhSachCauHinhBuoc)??[],F.value=(a==null?void 0:a.danhSachCauHinhBuoc)??[])}const p=b=>{x.value=b,v("emit_DanhSachCauHinh",k.value,d.value,x.value,f.value,m.value,N.value)},Y=b=>{d.value=b,v("emit_DanhSachCauHinh",k.value,d.value,x.value,f.value,m.value,N.value)},ll=b=>{M.value=b};return Ll(()=>T.DanhSachNode,(b,a)=>{j.value=b},{deep:!0}),(b,a)=>{const rl=Ne,hl=ye,al=Kl,vl=Ml("v-container-fluid");return P(),L(il,null,[t(pl,null,{default:o(()=>[t(el,null,{default:o(()=>[t(h,{cols:"12",md:"12"},{default:o(()=>[a[10]||(a[10]=l("div",{class:"FontDefault"},[l("h3",null,[S("1. Nội dung "),l("div",{style:{display:"inline-block","vertical-align":"middle",color:"red"}},"*")])],-1)),l("div",Te,[B(l("input",{type:"text","onUpdate:modelValue":a[0]||(a[0]=c=>A(f)?f.value=c:f=c),class:"FontDefault",placeholder:"VD: Cấu hình cho quy trình vận hành"},null,512),[[R,i(f)]])])]),_:1}),t(h,{cols:"12",md:"12"},{default:o(()=>[a[11]||(a[11]=l("div",{class:"FontDefault"},[l("h3",null,[S("2. Thiết lập mã phiếu (Ký tự đầu tiên, tối đa 4 ký tự) "),l("div",{style:{display:"inline-block","vertical-align":"middle",color:"red"}},"*")])],-1)),l("div",Se,[B(l("input",{type:"text","onUpdate:modelValue":a[1]||(a[1]=c=>A(m)?m.value=c:m=c),class:"FontDefault",placeholder:"VD: QT, quy trình sẽ phát sinh là 'QT' + 'mã phát sinh tự động', mã phiếu tạo là OT00001"},null,512),[[R,i(m)]])])]),_:1}),t(h,{cols:"12",md:"12"},{default:o(()=>[a[12]||(a[12]=l("div",{class:"FontDefault"},[l("h3",null,"3. Phân quyền cho phòng ban nào được tạo mã phiếu của quy trình ")],-1)),t(rl,{onEmit_phonganId:p})]),_:1}),t(h,{cols:"12",md:"12"},{default:o(()=>[a[13]||(a[13]=l("h4",null,"4. Phân quyền cho nhân sự nào được tạo mã phiếu của quy trình",-1)),t(hl,{ListPhongBanId:i(x),onEmit_nhansuId:Y},null,8,["ListPhongBanId"])]),_:1}),t(h,{cols:"12",md:"12"},{default:o(()=>[a[14]||(a[14]=l("div",{class:"FontDefault"},[l("h3",null,"5. Ghi chú")],-1)),l("div",Ve,[B(l("textarea",{class:"form-control",placeholder:"Nội dung ghi chú","onUpdate:modelValue":a[2]||(a[2]=c=>A(N)?N.value=c:N=c)},null,512),[[R,i(N)]])])]),_:1}),t(h,{cols:"12",md:"12"},{default:o(()=>[a[20]||(a[20]=l("div",{class:"FontDefault"},[l("h3",null,"6. Tạo nội dung thông tin"),l("div",{style:{display:"inline-block","vertical-align":"middle",color:"red"}},"* Ở mỗi quy trình, sẽ hiển thị theo số lương thông tin, để người dùng nhập vào"),l("br"),l("div",{style:{display:"inline-block","vertical-align":"middle",color:"red"}},"* Khi quy trình màn hình trước bị chỉnh sửa thì sẽ phải cấu hình lại thông tin")],-1)),l("table",we,[a[19]||(a[19]=l("thead",null,[l("tr",null,[l("th",{width:"50px"},"STT"),l("th",null,"Tên thông tin"),l("th",null,"Tình trạng"),l("th",{width:"100px"},"Cấu hình")])],-1)),l("tbody",null,[(P(!0),L(il,null,bl(i(k),(c,r)=>(P(),L("tr",{key:c.index??0},[l("td",null,W(r+1),1),l("td",null,W(c.tenThonTin),1),a[17]||(a[17]=l("td",null,null,-1)),l("td",Fe,[l("div",Be,[l("span",{class:"tooltip",onClick:C=>D(c.index)},a[15]||(a[15]=[l("i",{class:"fa fa-gear"},null,-1)]),8,Me),a[16]||(a[16]=l("span",{class:"tooltiptext"},"Cấu hình thông tin",-1))])])]))),128)),l("tr",null,[l("td",{colspan:"4",style:{"text-align":"center",cursor:"default"}},[l("div",{onClick:Q},a[18]||(a[18]=[l("span",{class:"tooltip"},[l("i",{class:"fa fa-plus"})],-1),S(" Tạo nội dung ")]))])])])])]),_:1})]),_:1})]),_:1}),l("div",{class:dl(["sliding-panel FontDefault",{open:i(V)}])},[l("div",_e,[t(vl,null,{default:o(()=>[t(el,null,{default:o(()=>[t(h,{cols:"12",md:"12"},{default:o(()=>[l("h3",null,"Cấu hình thông tin: "+W(i(I)),1)]),_:1}),t(h,{cols:"12",md:"12"},{default:o(()=>[a[21]||(a[21]=l("label",{class:"FontDefault"}," Tên thông tin ",-1)),B(l("input",{type:"text","onUpdate:modelValue":a[3]||(a[3]=c=>A(I)?I.value=c:I=c),class:"FontDefault",placeholder:"",style:{width:"100%"}},null,512),[[R,i(I)]])]),_:1}),t(h,{cols:"12",md:"12"},{default:o(()=>[a[22]||(a[22]=l("label",{class:"FontDefault"}," Nôi dung ",-1)),B(l("textarea",{class:"form-control",placeholder:"Nội dung ghi chú","onUpdate:modelValue":a[4]||(a[4]=c=>A(g)?g.value=c:g=c)},null,512),[[R,i(g)]])]),_:1}),t(h,{cols:"12",md:"12"},{default:o(()=>[a[23]||(a[23]=l("label",{class:"FontDefault"}," Cấu hình hiển thị ở bước ",-1)),t(al,{LoadNode:i(F),DanhSachNode:i(j),onEmit_dansachNode:ll},null,8,["LoadNode","DanhSachNode"])]),_:1}),t(h,{cols:"12",md:"12"},{default:o(()=>[a[24]||(a[24]=l("label",{class:"FontDefault"},[S(" Thông báo khi không nhập "),l("div"),l("div",{style:{display:"inline-block",color:"red"}}," * Sử dụng khi chọn bắt buộc nhập")],-1)),B(l("input",{type:"text",id:"",class:"FontDefault",placeholder:"",style:{width:"100%"},"onUpdate:modelValue":a[5]||(a[5]=c=>A(z)?z.value=c:z=c)},null,512),[[R,i(z)]])]),_:1}),t(h,{cols:"12",md:"6"},{default:o(()=>[a[27]||(a[27]=l("label",{class:"FontDefault"}," Loại ",-1)),l("div",Pe,[B(l("select",{id:"email",class:"combobox","onUpdate:modelValue":a[6]||(a[6]=c=>A(w)?w.value=c:w=c)},a[25]||(a[25]=[l("option",{value:"0"}," Nhập tự do ",-1),l("option",{value:"1"}," Nhập số ",-1)]),512),[[_l,i(w)]]),a[26]||(a[26]=l("span",{class:"combobox-icon"},"▼",-1))])]),_:1}),t(h,{cols:"12",md:"6"},{default:o(()=>[a[28]||(a[28]=l("label",{class:"FontDefault"}," Kích thước ký tự ",-1)),B(l("input",{type:"number","onUpdate:modelValue":a[7]||(a[7]=c=>A(U)?U.value=c:U=c),class:"FontDefault",placeholder:"",style:{width:"100%"}},null,512),[[R,i(U)]])]),_:1}),t(h,{cols:"12",md:"12"},{default:o(()=>[t(fl,{label:"Bắt buộc nhập.",class:"FontDefault",modelValue:i($),"onUpdate:modelValue":a[8]||(a[8]=c=>A($)?$.value=c:$=c)},null,8,["modelValue"]),t(fl,{label:"Có File đính kèm.",class:"FontDefault",style:{"margin-top":"-50px"},modelValue:i(H),"onUpdate:modelValue":a[9]||(a[9]=c=>A(H)?H.value=c:H=c)},null,8,["modelValue"])]),_:1}),t(h,{cols:"12",md:"12"},{default:o(()=>[t(tl,{class:"btnAdd btn no-uppercase",onClick:X,style:{float:"right"}},{default:o(()=>a[29]||(a[29]=[S(" Xác nhận ")])),_:1}),t(tl,{onClick:K,class:"btnCancel no-uppercase",style:{float:"right","margin-right":"10px"}},{default:o(()=>a[30]||(a[30]=[S(" Xóa ")])),_:1}),t(tl,{onClick:X,class:"btnCancel no-uppercase",style:{float:"right","margin-right":"10px"}},{default:o(()=>a[31]||(a[31]=[S(" Hủy ")])),_:1})]),_:1})]),_:1})]),_:1})])],2),l("div",{class:dl(["overlay",{show:i(V)}])},null,2)],64)}}}),Ae={class:"ChillColor"},Ee={class:"layoutChill"},Ue={for:"",class:"FontDefault",style:{"font-size":"20px",color:"#0099FF","font-weight":"bold"}},He={class:"input-container"},$e={class:"input-container"},qe={for:"",class:"FontDefault",style:{"font-size":"20px",color:"#0099FF","font-weight":"bold"}},la=cl({__name:"AddQuyTrinh",setup(ol){let q=n(0),V=n(""),x=n(!1),f="",m=n([]),N=n([]),I=n(""),g=n(""),G=n(""),M=new Date,w=n({visible:!1,color:"#CD3333",icon:"mdi-cancel",title:"Login Failed",text:"Invalid username or password. Please try again."});const $=n([]),H=n([]),z=n([]),U=n([]),F=n([]),d=n([]);function v(D){q.value=q.value+1,k(),x.value=!0}function T(){q.value=q.value-1,k(),x.value=!1}function k(){q.value==0?V.value="Cấu hình thông tin quy trình":q.value==1&&(V.value="Cấu hình thiết kế quy trình")}function j(D){$.value=D.INodeMap,H.value=D.IDiagram,z.value=D.INextStep,U.value=D.InodeSttings,F.value=D.INodeMap}async function J(){try{let D=await Cl("/api/quanlythongtin/QuyTrinhNode/AddQuyTrinhNode","POST",{tenQuyTrinh:f,userName:localStorage.getItem("UserName"),nodeMapModels:$.value,diagramNodeModels:H.value,nextStepNodeModels:z.value,nhanSuIds:m.value,phongBanIds:N.value,ghiChu:G.value,thietLapMaPhieu:g.value,noiDung:I.value,ngayBatDau:M,nodeSttings:U.value,cauHinhThongTins:d.value},{timeout:15e3});w.value.text="Thành công",w.value.visible=!0,w.value.color="#109011"}catch(D){w.value.text=D,w.value.visible=!0,w.value.color="#CD3333"}}function Q(){J()}const X=(D,p,Y,ll,b,a)=>{d.value=D,N.value=Y,m.value=p,I.value=ll,g.value=b,G.value=a},K=D=>{M=D};return gl(()=>{k()}),(D,p)=>{const Y=Ol,ll=Le,b=fe;return P(),L("div",Ae,[t(pl,null,{default:o(()=>[l("div",Ee,[B(l("div",null,[t(el,null,{default:o(()=>[t(h,{cols:"12",md:"6"},{default:o(()=>[l("label",Ue,W(i(V)),1)]),_:1}),t(h,{cols:"12",md:"6"},{default:o(()=>p[4]||(p[4]=[l("label",{for:"",class:"FontDefault",style:{float:"right"}},[l("i",{class:"fa-solid fa-book"}),S(" Hướng dẫn ")],-1)])),_:1}),t(h,{cols:"12",md:"6"},{default:o(()=>[l("div",He,[p[5]||(p[5]=l("label",{for:"",class:"FontDefault"},[l("div",{style:{display:"inline-block","vertical-align":"middle",color:"red"}},"*"),S(" Tên quy trình ")],-1)),B(l("input",{type:"text","onUpdate:modelValue":p[0]||(p[0]=a=>A(f)?f.value=a:f=a),class:"FontDefault",placeholder:"VD: Quy trình duyệt đơn"},null,512),[[R,i(f)]])])]),_:1}),t(h,{cols:"12",md:"6"},{default:o(()=>[l("div",$e,[p[6]||(p[6]=l("label",{for:"",class:"FontDefault"},[l("div",{style:{display:"inline-block","vertical-align":"middle",color:"red"}},"*"),S(" Ngày bắt đầu ")],-1)),t(Y,{onEmit_datetime:K})])]),_:1})]),_:1})],512),[[nl,i(q)==0]]),B(l("div",null,[t(el,null,{default:o(()=>[t(h,{cols:"12",md:"12"},{default:o(()=>[l("label",qe,W(i(V)),1)]),_:1}),t(ll,{DanhSachNode:i(F),onEmit_DanhSachCauHinh:X},null,8,["DanhSachNode"])]),_:1})],512),[[nl,i(q)==1]]),t(el,null,{default:o(()=>[t(h,{cols:"12",md:"6"},{default:o(()=>[B(l("button",{class:"btnAdd btn",onClick:T,style:{float:"left"}},p[7]||(p[7]=[l("span",{class:"icon-border"},[l("i",{class:"fas fa-arrow-left"})],-1),S(" Trả về trước ")]),512),[[nl,i(q)]])]),_:1}),B(t(h,{cols:"12",md:"6"},{default:o(()=>[l("button",{class:"btnAdd btn",onClick:p[1]||(p[1]=a=>v(!0)),style:{float:"right"}},p[8]||(p[8]=[S(" Bươc tiếp theo "),l("span",{class:"icon-border"},[l("i",{class:"fas fa-arrow-right"})],-1)]))]),_:1},512),[[nl,i(x)==!1]]),B(t(h,{cols:"12",md:"6"},{default:o(()=>[l("button",{class:"btnAdd btn",style:{float:"right"},onClick:p[2]||(p[2]=a=>Q())},p[9]||(p[9]=[S(" Tạo quy trình "),l("span",{class:"icon-border"},[l("i",{class:"fa fa-plus"})],-1)]))]),_:1},512),[[nl,i(x)==!0]])]),_:1})]),B(l("div",null,[t(b,{onEmit_Node:j})],512),[[nl,i(q)==0]])]),_:1}),t(ne,{modelValue:i(w).visible,"onUpdate:modelValue":p[3]||(p[3]=a=>i(w).visible=a),timeout:2e3,color:i(w).color},{default:o(()=>[t(pl,null,{default:o(()=>[t(el,null,{default:o(()=>[t(h,{cols:"1"},{default:o(()=>[t(jl,{color:"white"},{default:o(()=>[S(W(i(w).icon),1)]),_:1})]),_:1}),t(h,{cols:"11",style:{"padding-top":"14px"}},{default:o(()=>[S(W(i(w).text),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue","color"])])}}});export{la as default};
