import{d as S,P as m,ai as _,I as B,S as M,ah as z,o as y,a as C,b as s,aj as L,ak as T,al as G,F as O}from"./index-yLVU4Ex3.js";import{G as V,P as X,R as w,L as N,a as F,E as H}from"./standard-Cqu3hj39.js";import{_ as J}from"./_plugin-vue_export-helper-DlAUqK2U.js";const Q=S({__name:"Dashboard",setup(W){const d=m(null),p=m(!1),a=_({x:0,y:0}),D=B(()=>({top:`${a.y}px`,left:`${a.x}px`}));let u,i,v=null,c=null;const f=m({succeeded:!1,code:0,message:null,errors:null,data:[]});M(()=>{i=new V,u=new X({el:d.value,model:i,width:2500,height:2500,gridSize:10,drawGrid:!0}),u.on("element:contextmenu",(n,e,t,o)=>{e.preventDefault(),c=n.model,a.x=t,a.y=o,p.value=!0}),A()});async function A(){try{const n=await z("/api/quanlythongtin/QuyTrinhNode/GetQuyTrinhById?QuyTringId=55","GET",{},{timeout:15e3});f.value=n,console.log(f.value.data),P()}catch{}}function E(){I()}const P=()=>{u.setOrigin(0,0),f.value.data&&f.value.data.forEach(n=>{n.nodes.forEach(e=>{var g;const t=new w,o=JSON.parse(e.position),r=u.viewport.getBoundingClientRect(),l=(g=d.value)==null?void 0:g.getBoundingClientRect();l&&r&&(l.left,l.top,t.position(o.x,o.y)),t.resize(120,60),t.attr({body:{fill:"lightblue"},label:{text:e.label,fill:"black"}}),t.set("id",e.keyId),i.addCell(t)}),n.diagramNodes.forEach(e=>{const t=new N;t.source({id:e.source}),t.target({id:e.target});const o=typeof e.lineAttributes=="string"?JSON.parse(e.lineAttributes):e.lineAttributes;t.attr({line:{...o,stroke:o.stroke||"blue",strokeWidth:o.strokeWidth||2}}),i.addCell(t)})})},h=n=>{var r;if(!u)return;let e;if(n==="square"?(e=new w,e.resize(100,100)):n==="diamond"?(e=new F,e.attr({body:{refPoints:"50,0 100,50 50,100 0,50",fill:"orange"},label:{text:"Hình thoi",fill:"white"}}),e.resize(100,100)):n==="ellipse"&&(e=new H,e.attr({body:{fill:"lightblue"},label:{text:"Hình bầu dục",fill:"black"}}),e.resize(120,60)),!e)return;const t=(r=d.value)==null?void 0:r.getBoundingClientRect();if(t){const l=t.left+window.scrollX,g=t.top+window.scrollY;e.position(a.x-l,a.y-g)}i.addCell(e);const o=c||v;if(o){const l=new N;l.source(o),l.target(e),l.attr({line:{stroke:"blue",strokeWidth:2}}),i.addCell(l)}v=e,c=null,b(),k(),x()},I=()=>{const e=i.getCells().filter(t=>t.isElement());console.log("Danh sách các node và tọa độ của chúng:"),e.forEach(t=>{const o=t.id,r=t.position(),l=t.attr("label/text");console.log(`ID: ${o}, Label: ${l}, Position: (${r.x}, ${r.y})`)})},$=n=>{n.preventDefault(),p.value=!0,a.x=n.clientX,a.y=n.clientY},b=()=>{p.value=!1},R=()=>{c?(c.remove(),c=null):alert("Vui lòng chọn node cần xóa"),b(),k(),x()},k=()=>{const e=i.getElements().map(t=>({id:t.id,type:t.get("type"),position:t.position().toString(),label:t.attr("label/text")}));console.log("Danh sách các node:",e)},x=()=>{const e=i.getLinks().map(t=>({id:t.id,source:t.source().id,target:t.target().id,lineAttributes:JSON.stringify(t.attr("line"))}));console.log("Danh sách các liên kết:",e)};return(n,e)=>(y(),C(O,null,[s("div",null,[s("button",{onClick:E},"sdsads")]),s("div",null,[s("div",{ref_key:"paperContainer",ref:d,class:"diagram-container",onContextmenu:L($,["prevent"])},null,544),p.value?(y(),C("div",{key:0,style:T(D.value),class:"context-menu"},[s("ul",null,[s("li",{onClick:e[0]||(e[0]=t=>h("square"))},"Tạo hình vuông"),s("li",{onClick:e[1]||(e[1]=t=>h("diamond"))},"Tạo hình thoi"),s("li",{onClick:e[2]||(e[2]=t=>h("ellipse"))},"Tạo hình bầu dục"),s("li",{onClick:R},"Xóa node"),s("li",{onClick:b},"Hủy")])],4)):G("",!0)])],64))}}),K=J(Q,[["__scopeId","data-v-733e1432"]]);export{K as default};
